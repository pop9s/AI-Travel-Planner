# 💰 费用预算与管理功能

## 功能概述

AI Travel Planner 现已集成**智能费用预算与管理**功能，帮助您在旅行过程中实时跟踪开销，并通过 AI 获取专业的预算分析建议。

---

## ✨ 核心特性

### 1. 📊 实时预算监控
- **总预算**：显示您设定的旅行总预算
- **已花费**：自动累计所有记录的开销
- **剩余金额**：实时计算可用余额
- **可视化进度条**：
  - 🟢 绿色：预算充足（< 80%）
  - 🟡 黄色：预算紧张（80-100%）
  - 🔴 红色：预算超支（> 100%）

### 2. 🎤 语音记录开销
每个输入字段都支持语音输入：
- **金额**：说 "一百二十" → 自动识别为 120
- **备注**：快速语音描述消费详情
- **智能数字识别**：
  - "五十" → 50
  - "一百五" → 150
  - "两千块" → 2000
  - "一万" → 10000

### 3. 📝 分类管理
支持 6 大消费类别：
- 🍽️ **餐饮** (Food & Dining)
- 🚗 **交通** (Transportation)
- 🏨 **住宿** (Accommodation)
- 🎯 **活动** (Activities)
- 🛍️ **购物** (Shopping)
- 📦 **其他** (Other)

### 4. 🤖 AI 智能分析
点击 "AI 预算分析" 按钮，获取：
- ✅ 当前预算使用情况评估
- 📊 各类别支出合理性分析
- ⚠️ 超支风险预警
- 💡 剩余预算优化建议
- 💰 具体节省开支建议

---

## 🎯 使用场景

### 场景 1：记录餐饮费用
1. 吃完饭后，打开费用管理
2. 选择类别：**餐饮**
3. 点击金额旁的 🎤，说 "一百二十"
4. 点击备注旁的 🎤，说 "晚餐 意大利餐厅"
5. 点击 "添加费用"

### 场景 2：旅行中期预算检查
1. 已记录多笔开销
2. 点击 "AI 预算分析"
3. AI 分析：
   ```
   预算使用评估：
   - 已使用 65% 的预算
   - 交通费用占比较高（35%）
   - 建议：可考虑使用公共交通
   - 预计剩余预算可支持 3 天行程
   ```

### 场景 3：多人旅行 AA 制
1. 每次消费都记录
2. 所有费用清单一目了然
3. 行程结束后，导出费用明细
4. 快速计算每人应付金额

---

## 🌐 多语言支持

费用管理功能完全支持多语言：
- 🇨🇳 中文（简体）
- 🇺🇸 English
- 🇯🇵 日本語
- 🇰🇷 한국어

---

## 🔧 技术实现

### 前端组件
- **BudgetManager.tsx**：费用管理主组件
- **VoiceInput**：语音输入集成
- **实时统计**：React Hooks 状态管理

### 后端 API
- **`/api/budget-analysis`**：通义千问 AI 预算分析
- **智能提示词**：结合消费记录生成专业建议

### 语音识别
- 支持中文数字转换（"一千" → 1000）
- 支持阿拉伯数字（"250" → 250）
- 支持混合表达（"一千五" → 1500）

---

## 📱 界面展示

### 预算概览卡片
```
┌─────────────────────────────────────┐
│  💰 费用预算与管理                   │
│  智能记录旅行开销，AI分析预算       │
├─────────────────────────────────────┤
│  总预算        已花费        剩余    │
│  ¥10,000      ¥6,500      ¥3,500   │
│  [====65%=====     ]                │
└─────────────────────────────────────┘
```

### 添加费用表单
```
┌─────────────────────────────────────┐
│  类别: [餐饮 ▼]                     │
│  金额: [120] 🎤                     │
│  备注: [意大利餐厅] 🎤              │
│  [➕ 添加费用]                      │
└─────────────────────────────────────┘
```

### 费用列表
```
┌─────────────────────────────────────┐
│  餐饮  ¥120                    🗑️   │
│  意大利餐厅晚餐                     │
│  2024-01-15 18:30                   │
├─────────────────────────────────────┤
│  交通  ¥80                     🗑️   │
│  地铁往返                           │
│  2024-01-15 14:20                   │
└─────────────────────────────────────┘
```

---

## 💡 使用技巧

### 1. 及时记录
- ✅ 消费后立即记录
- ✅ 使用语音快速输入
- ✅ 添加详细备注

### 2. 定期分析
- 📅 每天晚上做一次 AI 分析
- 📊 了解主要开销类别
- 💰 及时调整消费计划

### 3. 分类清晰
- 🎯 准确选择消费类别
- 📝 方便后期统计分析
- 💡 帮助 AI 给出更精准建议

### 4. 预算预留
- 💡 建议预留 10-15% 作为应急资金
- ⚠️ 预算接近 80% 时开始控制
- 🚨 超支时及时调整后续计划

---

## 🚀 快速开始

### 1. 设置预算
在旅行计划表单中填写 **预算(CNY)** 字段

### 2. 开始记录
表单提交后，页面底部会自动显示 **费用预算与管理** 模块

### 3. 语音输入
- 点击 🎤 图标
- 允许麦克风权限
- 开始说话

### 4. AI 分析
- 记录至少 3-5 笔费用
- 点击 **AI 预算分析** 按钮
- 查看专业建议

---

## 📊 数据统计

费用管理会自动生成：
- ✅ 各类别支出统计
- ✅ 支出占比分析
- ✅ 平均每日花费
- ✅ 剩余天数预算规划

---

## 🔐 数据安全

- ✅ 所有数据仅存储在浏览器本地
- ✅ 不会上传到服务器
- ✅ 刷新页面后数据重置
- ⚠️ 如需长期保存，请自行备份

---

## 🎨 最佳实践

### 旅行前
1. 📋 制定详细预算计划
2. 💰 按类别分配预算
3. 🎯 设定每日消费上限

### 旅行中
1. 📝 及时记录每笔开销
2. 🎤 使用语音快速输入
3. 📊 每日查看预算使用情况
4. 🤖 定期请求 AI 分析

### 旅行后
1. 📈 回顾总体花费
2. 💡 总结消费经验
3. 🎯 为下次旅行提供参考

---

## 🆘 常见问题

### Q: 预算显示在哪里？
A: 在主表单中填写预算后，页面底部会自动显示费用管理模块。

### Q: 语音识别不准确怎么办？
A: 可以手动输入，或者尝试说得更清晰。如果配置了科大讯飞，识别准确度会大幅提升。

### Q: 费用记录会保存吗？
A: 当前版本数据仅存储在浏览器，刷新后会清空。未来版本会支持数据导出。

### Q: AI 分析需要多久？
A: 通常 2-5 秒即可完成分析。

### Q: 可以修改已记录的费用吗？
A: 当前版本只支持删除，如需修改请删除后重新添加。

---

## 🎉 功能亮点总结

✅ **语音输入** - 快速便捷记录开销  
✅ **AI 分析** - 专业预算建议  
✅ **实时监控** - 预算使用一目了然  
✅ **多语言** - 支持 4 种语言界面  
✅ **分类管理** - 6 大消费类别  
✅ **可视化** - 直观的进度条和统计

---

**祝您旅途愉快，预算管理轻松无忧！** 🎒✈️💰

