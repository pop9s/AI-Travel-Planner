# ğŸ” ä¿å­˜è®¡åˆ’é—®é¢˜è¯Šæ–­æŒ‡å—

## é—®é¢˜ï¼šä¿å­˜è®¡åˆ’æ—¶æ˜¾ç¤º"æœªç™»å½•"

### å·²ä¿®å¤çš„é—®é¢˜

1. **æœåŠ¡å™¨ç«¯ Supabase å®¢æˆ·ç«¯é…ç½®ä¸å®Œæ•´**
   - âŒ ä¹‹å‰ï¼šåªæœ‰ `get` æ–¹æ³•
   - âœ… ç°åœ¨ï¼šæ·»åŠ äº† `set` å’Œ `remove` æ–¹æ³•
   - æ–‡ä»¶ï¼š`lib/supabase-server.ts`

2. **å­—æ®µåæ˜ å°„é—®é¢˜**
   - âŒ ä¹‹å‰ï¼šç›´æ¥ä½¿ç”¨å‰ç«¯çš„é©¼å³°å‘½å
   - âœ… ç°åœ¨ï¼šè½¬æ¢ä¸ºæ•°æ®åº“çš„è›‡å½¢å‘½å
   - æ–‡ä»¶ï¼š`app/api/travel-plans/route.ts`

3. **é”™è¯¯æ—¥å¿—å¢å¼º**
   - æ·»åŠ äº†è¯¦ç»†çš„æ—¥å¿—è¾“å‡º
   - ä¾¿äºæ’æŸ¥é—®é¢˜

### å¦‚ä½•æµ‹è¯•

1. **é‡å¯å¼€å‘æœåŠ¡å™¨**
   ```bash
   # åœæ­¢æœåŠ¡å™¨ (Ctrl+C)
   npm run dev
   ```

2. **ç™»å½•è´¦å·**
   - ç‚¹å‡»å³ä¸Šè§’"ç™»å½•"æŒ‰é’®
   - è¾“å…¥é‚®ç®±å’Œå¯†ç ç™»å½•

3. **ç”Ÿæˆæ—…è¡Œè®¡åˆ’**
   - å¡«å†™æ—…è¡Œä¿¡æ¯
   - ç‚¹å‡»"ç”Ÿæˆæ—…è¡Œè®¡åˆ’"æŒ‰é’®

4. **ä¿å­˜è®¡åˆ’**
   - ç‚¹å‡»"ä¿å­˜è®¡åˆ’"æŒ‰é’®
   - åº”è¯¥çœ‹åˆ°"ä¿å­˜æˆåŠŸ"çš„æç¤º

### æŸ¥çœ‹è°ƒè¯•ä¿¡æ¯

æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å° (F12) å’ŒæœåŠ¡å™¨ç»ˆç«¯ï¼ŒæŸ¥çœ‹ï¼š

#### æµè§ˆå™¨æ§åˆ¶å°
- è®¤è¯çŠ¶æ€å˜åŒ–æ—¥å¿—
- API è¯·æ±‚å’Œå“åº”

#### æœåŠ¡å™¨ç»ˆç«¯
- `æœåŠ¡å™¨ç«¯ï¼šè·å–åˆ°ç”¨æˆ· [ç”¨æˆ·ID] [é‚®ç®±]` - è¡¨ç¤ºè·å–ç”¨æˆ·æˆåŠŸ
- `æœåŠ¡å™¨ç«¯ï¼šæ— ç”¨æˆ· session` - è¡¨ç¤ºæ²¡æœ‰ session
- `å‡†å¤‡æ’å…¥æ•°æ®åº“:` - æ˜¾ç¤ºè¦æ’å…¥çš„æ•°æ®
- `ä¿å­˜æˆåŠŸ:` - æ˜¾ç¤ºä¿å­˜çš„ç»“æœ

### å¯èƒ½çš„é—®é¢˜

#### é—®é¢˜ 1: ä»ç„¶æ˜¾ç¤º"æœªç™»å½•"

**æ£€æŸ¥æ­¥éª¤ï¼š**
1. æŸ¥çœ‹æœåŠ¡å™¨ç»ˆç«¯ï¼Œçœ‹æ˜¯å¦æœ‰"æ— ç”¨æˆ· session"æ—¥å¿—
2. æ£€æŸ¥æµè§ˆå™¨ Application > Cookiesï¼Œç¡®è®¤æœ‰ Supabase çš„ cookies
3. å°è¯•é€€å‡ºç™»å½•åé‡æ–°ç™»å½•

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# 1. æ¸…é™¤æµè§ˆå™¨ cookies å’Œç¼“å­˜
# 2. é‡å¯å¼€å‘æœåŠ¡å™¨
npm run dev
# 3. é‡æ–°ç™»å½•
```

#### é—®é¢˜ 2: æ•°æ®åº“æ’å…¥å¤±è´¥

**æ£€æŸ¥æ­¥éª¤ï¼š**
1. æŸ¥çœ‹æœåŠ¡å™¨ç»ˆç«¯çš„"æ•°æ®åº“æ’å…¥é”™è¯¯"æ—¥å¿—
2. æ£€æŸ¥ Supabase Dashboard ä¸­çš„è¡¨ç»“æ„
3. ç¡®è®¤ RLS (Row Level Security) ç­–ç•¥æ­£ç¡®

**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥ Supabase Dashboard > Table Editor > travel_plans
- ç¡®è®¤è¡¨ç»“æ„ä¸ä»£ç ä¸­çš„å­—æ®µåŒ¹é…
- æ£€æŸ¥ RLS ç­–ç•¥æ˜¯å¦å…è®¸æ’å…¥

#### é—®é¢˜ 3: å­—æ®µéªŒè¯å¤±è´¥

**æ£€æŸ¥æ­¥éª¤ï¼š**
1. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°çš„ Network æ ‡ç­¾
2. æŸ¥çœ‹è¯·æ±‚ body ä¸­çš„æ•°æ®
3. æ£€æŸ¥æ˜¯å¦æ‰€æœ‰å¿…å¡«å­—æ®µéƒ½å·²å¡«å†™

**è§£å†³æ–¹æ¡ˆï¼š**
- ç¡®ä¿æ‰€æœ‰å¿…å¡«å­—æ®µéƒ½å·²å¡«å†™ï¼š
  - destination (ç›®çš„åœ°)
  - startDate (å¼€å§‹æ—¥æœŸ)
  - duration (å¤©æ•°)
  - travelers (äººæ•°)
  - budget (é¢„ç®—)
  - interests (å…´è¶£)

### æµ‹è¯•æ¸…å•

- [ ] ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
- [ ] Supabase é¡¹ç›®æ­£å¸¸è¿è¡Œ
- [ ] èƒ½å¤ŸæˆåŠŸç™»å½•
- [ ] èƒ½å¤Ÿç”Ÿæˆæ—…è¡Œè®¡åˆ’
- [ ] èƒ½å¤Ÿä¿å­˜è®¡åˆ’
- [ ] èƒ½å¤Ÿåœ¨"æˆ‘çš„è®¡åˆ’"ä¸­æŸ¥çœ‹ä¿å­˜çš„è®¡åˆ’

### å¸¸è§é”™è¯¯ä¿¡æ¯

| é”™è¯¯ä¿¡æ¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|---------|------|---------|
| æœªç™»å½• | æœåŠ¡å™¨ç«¯æ— æ³•è·å– session | é‡æ–°ç™»å½•ï¼Œç¡®ä¿ cookies æ­£å¸¸ |
| è¾“å…¥æ•°æ®éªŒè¯å¤±è´¥ | å¿…å¡«å­—æ®µç¼ºå¤± | æ£€æŸ¥æ‰€æœ‰å­—æ®µæ˜¯å¦å¡«å†™ |
| relation "public.travel_plans" does not exist | æ•°æ®è¡¨ä¸å­˜åœ¨ | è¿è¡Œ SQL è¿ç§»è„šæœ¬ |
| new row violates row-level security policy | RLS ç­–ç•¥é—®é¢˜ | æ£€æŸ¥ Supabase RLS ç­–ç•¥ |

### ç›¸å…³æ–‡ä»¶

- `lib/supabase-server.ts` - æœåŠ¡å™¨ç«¯ Supabase é…ç½®
- `app/api/travel-plans/route.ts` - æ—…è¡Œè®¡åˆ’ API
- `app/page.tsx` - ä¸»é¡µé¢ï¼ˆåŒ…å«ä¿å­˜é€»è¾‘ï¼‰
- `supabase/migrations/001_initial_schema.sql` - æ•°æ®åº“è¿ç§»è„šæœ¬

---

**æ›´æ–°æ—¶é—´**: 2025-11-10
**ç‰ˆæœ¬**: v2.1.2

