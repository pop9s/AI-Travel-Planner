# 🗺️ 地图导航功能

## 功能概述

AI Travel Planner 现已集成高德地图 API，为您的旅行规划提供强大的地图导航功能！

## ✨ 主要功能

### 1. 📍 自动地理定位
- 自动将旅行目的地转换为地图坐标
- 支持国内外主要城市和景点
- 智能地理编码服务

### 2. 🗺️ 交互式地图展示
- 高清 3D 地图视图
- 平滑缩放和拖拽
- 响应式设计，适配所有设备

### 3. 🔍 智能地点搜索
- 搜索景点、餐厅、酒店
- 实时搜索建议
- 地图上标记搜索结果

### 4. 🧭 路线规划与导航
- 计算两地间的驾车路线
- 显示距离和预计时间
- 多种出行方案选择

### 5. 📌 地点标记与详情
- 自动标记旅行目的地
- 点击标记查看详情
- 支持多地点同时展示

## 🚀 快速开始

### 第一步：配置 API Key

1. 前往 [高德开放平台](https://lbs.amap.com/) 注册账号
2. 创建应用并获取 API Key
3. 在 `.env.local` 文件中添加配置：

```bash
NEXT_PUBLIC_AMAP_KEY=你的API密钥
NEXT_PUBLIC_AMAP_SECURITY_KEY=你的安全密钥
```

详细配置步骤请查看 [高德地图 API 配置指南](./docs/AMAP_SETUP.md)

### 第二步：重启服务器

```bash
npm run dev
```

### 第三步：查看地图

1. 创建或打开一个旅行计划
2. 在计划详情页即可看到地图
3. 使用搜索和导航功能探索目的地

## 📱 使用场景

### 🏖️ 旅行规划
- 查看目的地位置
- 搜索周边景点
- 规划游览路线

### 🍽️ 美食探索
- 搜索附近餐厅
- 查看美食地图
- 计算前往距离

### 🏨 住宿查找
- 搜索酒店位置
- 查看交通便利性
- 规划往返路线

### 🎯 行程优化
- 多地点路线规划
- 时间距离估算
- 最优路径推荐

## 🎨 界面展示

### 旅行计划详情页
```
┌─────────────────────────────────────┐
│  🗺️ 地图导航                       │
│  ┌───────────────────────────────┐  │
│  │  🔍 搜索地点、景点、餐厅...   │  │
│  └───────────────────────────────┘  │
│                                     │
│  ┌───────────────────────────────┐  │
│  │                               │  │
│  │      🗺️  地图显示区域          │  │
│  │        📍 目的地标记           │  │
│  │                               │  │
│  └───────────────────────────────┘  │
│                                     │
│  📍 北京市                          │
│  北京市东城区                       │
│  🧭 导航                            │
└─────────────────────────────────────┘
```

## 🔧 技术实现

### 组件架构
- `MapView.tsx` - 地图展示组件
- `/api/geocode` - 地理编码 API 路由
- `types/amap.d.ts` - 高德地图类型定义

### 核心技术
- 高德地图 JavaScript API v2.0
- Next.js 14 App Router
- TypeScript
- React Hooks

### API 服务
- 地图展示：`AMap.Map`
- 地点搜索：`AMap.PlaceSearch`
- 路线规划：`AMap.Driving`
- 地理编码：`AMap.Geocoder`

## 📊 功能对比

| 功能 | 开发环境 | 生产环境 |
|------|----------|----------|
| 地图展示 | ✅ | ✅ |
| 地点搜索 | ✅ | ✅ |
| 路线规划 | ✅ | ✅ |
| 实时路况 | ✅ | ✅（需配额） |
| 周边搜索 | ✅ | ✅ |

## 🔐 安全性

### API Key 保护
- 使用环境变量存储密钥
- 设置安全密钥（securityJsCode）
- 配置域名白名单（生产环境推荐）

### 数据隐私
- 不存储用户位置信息
- 搜索记录仅保留在客户端
- 符合隐私保护规范

## 🐛 故障排除

### 地图无法加载
1. 检查 API Key 配置
2. 查看浏览器控制台错误
3. 确认网络连接正常
4. 验证 Key 服务平台设置

### 搜索无结果
1. 检查搜索关键词
2. 确认 API 配额充足
3. 尝试更具体的搜索词

### 路线规划失败
1. 验证起点终点坐标
2. 确认在服务范围内
3. 检查 API 权限设置

详细问题解答请查看 [配置指南](./docs/AMAP_SETUP.md#常见问题)

## 📈 未来规划

- [ ] 实时路况显示
- [ ] 公交/地铁路线规划
- [ ] 周边推荐（美食、酒店、景点）
- [ ] 离线地图支持
- [ ] 多语言地图标注
- [ ] AR 导航（移动端）
- [ ] 语音导航播报

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可

本功能遵循项目主许可证。

---

**开始使用地图导航功能，让您的旅行规划更加直观便捷！** 🎉

